사용자의 의도를 정확히 파악했습니다.

**핵심 목표:**

1. 기존 5단계 페르소나(1\~5)를 **세부 페르소나(Sub-persona)** 구조로 고도화.  
2. 특히 \*\*'위약금 해방 솔루션'\*\*의 타겟인 \*\*\[3번: 보안업체 비교 고객\]\*\*을 \*\*3-1(진입/비교)\*\*과 \*\*3-2(이탈/고통)\*\*로 명확히 분리하여 DB화.  
3. 나머지(1, 2, 4, 5)는 구조적 통일성을 위해 임의의 단일 세부 분류(x-1)로 우선 설정.

이 작업을 로컬 환경의 **Claude Code**가 즉시 수행할 수 있도록, 데이터베이스 스키마 수정부터 마이그레이션 로직 업데이트까지 포함한 상세 프롬프트를 작성해 드립니다.

---

### **📋 Claude Code 전달용 프롬프트**

이 내용을 그대로 복사해서 터미널의 Claude Code에게 붙여넣으세요.

Markdown

\# 미션: 키워드 페르소나 시스템 고도화 (세부 분류 체계 도입)

현재 구축된 \`keyword\_persona.db\` 시스템을 업그레이드해야 합니다.  
단순 5단계 분류(1\~5)를 넘어, 마케팅 액션에 직결되는 **\*\*세부 분류(Sub-persona)\*\*** 체계를 도입하고, 특히 우리 회사의 핵심 전략인 "위약금 해방(Un-carrier)" 캠페인을 위해 **\*\*3번 페르소나(보안업체 비교)\*\***를 정밀하게 타게팅할 수 있도록 데이터를 재구조화해주세요.

\---

\#\# 1\. 변경된 페르소나 정의 (반드시 이 규칙을 따를 것)

**\*\*핵심 타겟: \[3. 보안업체 비교 고객\] 분리\*\***  
\* **\*\*3-1: \[진입/비교 단계\]\*\***  
    \* **\*\*정의:\*\*** 브랜드를 고민하거나 신규 가입 가격을 알아보는 고객  
    \* **\*\*키워드 패턴:\*\*** 가격, 비용, 추천, 종류, 설치비, (브랜드명 단독), 견적  
\* **\*\*3-2: \[이탈/고통 단계\] (🔥 최우선 타겟)\*\***  
    \* **\*\*정의:\*\*** 기존 업체에 불만이 있거나, 해지/위약금 문제로 고통받는 잠재적 전환 고객  
    \* **\*\*키워드 패턴:\*\*** **\*\*위약금, 해지, 철거, 고객센터, AS, 불만, 약정, 이전\*\***

**\*\*기타 분류 (구조적 통일성을 위한 임의 설정)\*\***  
\* **\*\*1-1: \[홈캠 일반\]\*\*** (기존 1번 전체)  
\* **\*\*2-1: \[DIY 일반\]\*\*** (기존 2번 전체)  
\* **\*\*4-1: \[B2B 일반\]\*\*** (기존 4번 전체)  
\* **\*\*5-1: \[기타\]\*\*** (기존 5번 전체)

\---

\#\# 2\. 작업 지시 사항

다음 3단계 작업을 순차적으로 수행하는 파이썬 스크립트들을 수정/작성하고 실행해주세요.

\#\#\# Step 1\. DB 스키마 변경 (\`scripts/setup*\_keyword\_*persona*\_db.py\` 수정)*  
*1\.  \`customer\_*personas\` 테이블에 \`parent*\_id\` 컬럼을 추가하거나, 구조를 변경하여 메인 페르소나(1\~5)와 세부 페르소나(x-y)를 관리할 수 있게 하세요.*  
    *\* 가장 쉬운 방법: \`keywords\_*master\` 테이블에 \`sub*\_persona\_*id\` (VARCHAR, 예: "3-2") 컬럼 추가.  
2\.  기존 데이터가 날아가지 않도록 \`ALTER TABLE\`을 사용하거나, 안전한 마이그레이션 전략을 사용하세요.

\#\#\# Step 2\. 자동 라벨링 로직 고도화 (\`scripts/migrate*\_keyword\_*data.py\` 수정)  
\`auto\_label\_keyword\` 함수를 전면 개편하여 위에서 정의한 **\*\*세부 분류 규칙\*\***을 적용하세요.

**\*\*\[알고리즘 로직\]\*\***  
1\.  기존 1차 분류(1\~5) 로직 수행.  
2\.  만약 **\*\*3번(보안업체 비교)\*\***으로 분류되었다면, 2차 필터링 수행:  
    \* 키워드에 \`\['위약금', '해지', '철거', '고객센터', 'AS', '수리', '약정', '기간', '만료', '이전'\]\` 등이 포함되면 \-\> **\*\*"3-2"\*\***  
    \* 그 외(단순 브랜드명, 가격 등) \-\> **\*\*"3-1"\*\***  
3\.  나머지 번호(1, 2, 4, 5)는 자동으로 "-1"을 붙여 할당 (예: 1 \-\> 1-1).

\#\#\# Step 3\. 데이터 재처리 및 검증 (\`scripts/reclassify*\_keywords.py\` 신규 생성)*  
*1\.  기존 DB(\`keyword\_*persona.db\`)에 저장된 모든 키워드를 불러옵니다.  
2\.  새로운 로직으로 \`sub\_persona\_id\`를 다시 계산하여 업데이트합니다.  
3\.  업데이트 후, **\*\*3-1과 3-2로 분류된 키워드 샘플 10개씩\*\***을 출력하여 로직이 제대로 작동했는지 보여주세요.

\---

\#\# 3\. 실행 목표  
이 작업이 끝나면, 나는 DB에서 \`sub\_persona\_id \= '3-2'\` 쿼리만 날려서 "위약금 문제 해결" 블로그 포스팅을 위한 키워드 리스트를 즉시 뽑을 수 있어야 합니다.

---

### **💡 전략적 배경 (참고용)**

자동님, 이 프롬프트는 단순한 분류가 아니라 **"돈이 되는 고객"을 핀셋으로 집어내기 위한 작업**입니다.

* **3-1 (진입):** 일반적인 영업 대상입니다. (경쟁 치열함)  
* **3-2 (이탈):** 우리가 준비한 **"Un-carrier(위약금 해방)"** 전략이 100% 먹혀드는, 경쟁자가 놓치고 있는 **알짜배기 고객**입니다.

클로드 코드가 이 작업을 마치면, 바로 **3-2 그룹의 키워드**들만 뽑아서 "위약금 공포 마케팅" 글을 쏟아낼 준비가 완료됩니다.